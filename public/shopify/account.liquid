{% comment %}
  ============================================
  SECCI√ìN: MI CUENTA - C√≥digo Portable para Shopify
  ============================================
  
  Instrucciones de instalaci√≥n:
  1. Copia todo este contenido
  2. Ve a tu Admin de Shopify > Tienda Online > Temas > Editar c√≥digo
  3. Busca o crea el archivo: templates/customers/account.liquid
  4. Pega todo el contenido y guarda
  
  Personalizaci√≥n:
  - Modifica las variables CSS al inicio del <style> para cambiar colores
  - Los metafields de preferencias deben configurarse en Shopify Admin
{% endcomment %}

<div class="account-page">
  <!-- Toast Notification -->
  <div id="toast-container"></div>

  <!-- Header -->
  <div class="account-header">
    <div class="account-avatar" id="user-avatar">
      {% if customer.first_name != blank and customer.last_name != blank %}
        {{ customer.first_name | slice: 0 | upcase }}{{ customer.last_name | slice: 0 | upcase }}
      {% else %}
        {{ customer.email | slice: 0 | upcase }}
      {% endif %}
    </div>
    <div class="account-header-info">
      <h1 class="account-title">Mi Cuenta</h1>
      <p class="account-subtitle">Gestiona tu informaci√≥n personal y preferencias</p>
    </div>
  </div>

  <!-- Tabs Navigation -->
  <div class="account-tabs" role="tablist">
    <button class="account-tab active" data-tab="profile" role="tab" aria-selected="true" aria-controls="panel-profile">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
      </svg>
      Perfil
    </button>
    <button class="account-tab" data-tab="security" role="tab" aria-selected="false" aria-controls="panel-security">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
      </svg>
      Seguridad
    </button>
    <button class="account-tab" data-tab="preferences" role="tab" aria-selected="false" aria-controls="panel-preferences">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="3"></circle>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
      </svg>
      Preferencias
    </button>
    <button class="account-tab" data-tab="coupons" role="tab" aria-selected="false" aria-controls="panel-coupons">
      <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 5H3a2 2 0 00-2 2v4a2 2 0 002 2 2 2 0 010 4 2 2 0 00-2 2v4a2 2 0 002 2h18a2 2 0 002-2v-4a2 2 0 00-2-2 2 2 0 010-4 2 2 0 002-2V7a2 2 0 00-2-2z"></path>
        <path d="M10 5v18"></path>
      </svg>
      Cupones
    </button>
  </div>

  <!-- Tab Panels -->
  <div class="account-panels">
    
    <!-- Profile Panel -->
    <div class="account-panel active" id="panel-profile" role="tabpanel" aria-labelledby="tab-profile">
      <div class="account-card">
        <div class="card-header">
          <h2 class="card-title">Informaci√≥n Personal</h2>
          <p class="card-description">Actualiza tu informaci√≥n de perfil y foto</p>
        </div>
        <div class="card-content">
          <form id="profile-form" action="/account" method="post">
            <input type="hidden" name="form_type" value="customer">
            <input type="hidden" name="utf8" value="‚úì">
            
            <!-- Avatar Section -->
            <div class="avatar-section">
              <div class="avatar-upload">
                <div class="avatar-large" id="avatar-display">
                  {% if customer.first_name != blank and customer.last_name != blank %}
                    {{ customer.first_name | slice: 0 | upcase }}{{ customer.last_name | slice: 0 | upcase }}
                  {% else %}
                    {{ customer.email | slice: 0 | upcase }}
                  {% endif %}
                </div>
                <div class="avatar-actions">
                  <label class="btn btn-outline btn-sm" for="avatar-input">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                      <polyline points="17 8 12 3 7 8"></polyline>
                      <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    Subir foto
                  </label>
                  <input type="file" id="avatar-input" accept="image/*" hidden>
                  <p class="avatar-hint">JPG, PNG o GIF. M√°ximo 2MB</p>
                </div>
              </div>
            </div>

            <div class="divider"></div>

            <!-- Form Fields -->
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label" for="first_name">Nombre</label>
                <input 
                  type="text" 
                  id="first_name" 
                  name="customer[first_name]" 
                  class="form-input" 
                  value="{{ customer.first_name }}"
                  placeholder="Tu nombre"
                >
              </div>
              <div class="form-group">
                <label class="form-label" for="last_name">Apellido</label>
                <input 
                  type="text" 
                  id="last_name" 
                  name="customer[last_name]" 
                  class="form-input" 
                  value="{{ customer.last_name }}"
                  placeholder="Tu apellido"
                >
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="email">Correo electr√≥nico</label>
              <input 
                type="email" 
                id="email" 
                name="customer[email]" 
                class="form-input" 
                value="{{ customer.email }}"
                placeholder="tu@email.com"
              >
            </div>

            <div class="form-group">
              <label class="form-label" for="phone">Tel√©fono</label>
              <input 
                type="tel" 
                id="phone" 
                name="customer[phone]" 
                class="form-input" 
                value="{{ customer.phone }}"
                placeholder="+52 55 1234 5678"
              >
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary">
                Guardar cambios
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Security Panel -->
    <div class="account-panel" id="panel-security" role="tabpanel" aria-labelledby="tab-security">
      <div class="account-card">
        <div class="card-header">
          <h2 class="card-title">Cambiar Contrase√±a</h2>
          <p class="card-description">Aseg√∫rate de usar una contrase√±a fuerte</p>
        </div>
        <div class="card-content">
          <form id="password-form" action="/account" method="post">
            <input type="hidden" name="form_type" value="change_password">
            <input type="hidden" name="utf8" value="‚úì">
            
            <div class="form-group">
              <label class="form-label" for="current_password">Contrase√±a actual</label>
              <div class="password-input-wrapper">
                <input 
                  type="password" 
                  id="current_password" 
                  name="customer[current_password]" 
                  class="form-input" 
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                  autocomplete="current-password"
                >
                <button type="button" class="password-toggle" data-target="current_password">
                  <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                </button>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="new_password">Nueva contrase√±a</label>
              <div class="password-input-wrapper">
                <input 
                  type="password" 
                  id="new_password" 
                  name="customer[password]" 
                  class="form-input" 
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                  autocomplete="new-password"
                  minlength="8"
                >
                <button type="button" class="password-toggle" data-target="new_password">
                  <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                </button>
              </div>
              <p class="form-hint">M√≠nimo 8 caracteres</p>
            </div>

            <div class="form-group">
              <label class="form-label" for="confirm_password">Confirmar contrase√±a</label>
              <div class="password-input-wrapper">
                <input 
                  type="password" 
                  id="confirm_password" 
                  name="customer[password_confirmation]" 
                  class="form-input" 
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                  autocomplete="new-password"
                >
                <button type="button" class="password-toggle" data-target="confirm_password">
                  <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                </button>
              </div>
              <p class="form-error" id="password-error" hidden>Las contrase√±as no coinciden</p>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary" id="change-password-btn">
                Cambiar contrase√±a
              </button>
            </div>
          </form>
        </div>
      </div>

      <div class="account-card">
        <div class="card-header">
          <h2 class="card-title">Autenticaci√≥n de dos factores</h2>
          <p class="card-description">A√±ade una capa extra de seguridad a tu cuenta</p>
        </div>
        <div class="card-content">
          <div class="toggle-row">
            <div class="toggle-info">
              <span class="toggle-label">Habilitar 2FA</span>
              <span class="toggle-description">Recibe un c√≥digo de verificaci√≥n al iniciar sesi√≥n</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="toggle-2fa">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <p class="info-note">
            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
            La autenticaci√≥n de dos factores protege tu cuenta incluso si alguien obtiene tu contrase√±a.
          </p>
        </div>
      </div>
    </div>

    <!-- Preferences Panel -->
    <div class="account-panel" id="panel-preferences" role="tabpanel" aria-labelledby="tab-preferences">
      <div class="account-card">
        <div class="card-header">
          <h2 class="card-title">Idioma y Regi√≥n</h2>
          <p class="card-description">Personaliza tu experiencia</p>
        </div>
        <div class="card-content">
          <div class="form-group">
            <label class="form-label" for="language">Idioma preferido</label>
            <div class="select-wrapper">
              <select id="language" class="form-select">
                <option value="es" selected>Espa√±ol</option>
                <option value="en">English</option>
                <option value="pt">Portugu√™s</option>
                <option value="fr">Fran√ßais</option>
              </select>
              <svg class="select-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <div class="account-card">
        <div class="card-header">
          <h2 class="card-title">Notificaciones</h2>
          <p class="card-description">Configura c√≥mo quieres recibir actualizaciones</p>
        </div>
        <div class="card-content">
          <div class="toggle-list">
            <div class="toggle-row">
              <div class="toggle-info">
                <span class="toggle-label">Notificaciones por email</span>
                <span class="toggle-description">Recibe actualizaciones en tu correo</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-email" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="divider"></div>

            <div class="toggle-row">
              <div class="toggle-info">
                <span class="toggle-label">Notificaciones por SMS</span>
                <span class="toggle-description">Recibe mensajes de texto importantes</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-sms">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="divider"></div>

            <div class="toggle-row">
              <div class="toggle-info">
                <span class="toggle-label">Actualizaciones de pedidos</span>
                <span class="toggle-description">Estado de env√≠o y entrega</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-orders" checked>
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div class="divider"></div>

            <div class="toggle-row">
              <div class="toggle-info">
                <span class="toggle-label">Ofertas y promociones</span>
                <span class="toggle-description">Descuentos exclusivos y novedades</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="toggle-promos">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn btn-primary" id="save-preferences">
              Guardar preferencias
            </button>
        </div>
      </div>
    </div>

    <!-- Coupons Panel -->
    <div class="account-panel" id="panel-coupons" role="tabpanel" aria-labelledby="tab-coupons">
      <!-- Active Coupons -->
      <div class="account-card">
        <div class="card-header">
          <h2 class="card-title">Mis Cupones de Descuento</h2>
          <p class="card-description">Copia el c√≥digo y apl√≠calo en tu pr√≥xima compra</p>
        </div>
        <div class="card-content">
          <div class="coupons-grid">
            <!-- Coupon 1 - Percentage -->
            <div class="coupon-card">
              <div class="coupon-left">
                <div class="coupon-discount">15%</div>
                <div class="coupon-type">DESCUENTO</div>
              </div>
              <div class="coupon-right">
                <div class="coupon-title">Descuento de Bienvenida</div>
                <div class="coupon-description">En tu primera compra mayor a $500</div>
                <div class="coupon-code-wrapper">
                  <span class="coupon-code">BIENVENIDO15</span>
                  <button class="copy-btn" data-code="BIENVENIDO15">
                    <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </button>
                </div>
                <div class="coupon-expiry">
                  <svg class="clock-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                  V√°lido hasta 31 Ene 2026
                </div>
              </div>
            </div>

            <!-- Coupon 2 - Fixed Amount -->
            <div class="coupon-card">
              <div class="coupon-left coupon-left-secondary">
                <div class="coupon-discount">$200</div>
                <div class="coupon-type">DESCUENTO</div>
              </div>
              <div class="coupon-right">
                <div class="coupon-title">Cup√≥n de Cumplea√±os</div>
                <div class="coupon-description">Celebra con este descuento especial</div>
                <div class="coupon-code-wrapper">
                  <span class="coupon-code">CUMPLE200</span>
                  <button class="copy-btn" data-code="CUMPLE200">
                    <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </button>
                </div>
                <div class="coupon-expiry">
                  <svg class="clock-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                  V√°lido hasta 15 Feb 2026
                </div>
              </div>
            </div>

            <!-- Coupon 3 - Free Shipping -->
            <div class="coupon-card">
              <div class="coupon-left coupon-left-accent">
                <div class="coupon-discount">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="shipping-icon">
                    <rect x="1" y="3" width="15" height="13"></rect>
                    <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                    <circle cx="5.5" cy="18.5" r="2.5"></circle>
                    <circle cx="18.5" cy="18.5" r="2.5"></circle>
                  </svg>
                </div>
                <div class="coupon-type">ENV√çO GRATIS</div>
              </div>
              <div class="coupon-right">
                <div class="coupon-title">Env√≠o Gratis</div>
                <div class="coupon-description">En compras mayores a $300</div>
                <div class="coupon-code-wrapper">
                  <span class="coupon-code">ENVIOGRATIS</span>
                  <button class="copy-btn" data-code="ENVIOGRATIS">
                    <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                      <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                  </button>
                </div>
                <div class="coupon-expiry">
                  <svg class="clock-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                  </svg>
                  Sin fecha de expiraci√≥n
                </div>
              </div>
            </div>
          </div>

          <p class="info-note" style="margin-top: 1.5rem;">
            <svg class="info-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="16" x2="12" y2="12"></line>
              <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
            Los cupones se aplican autom√°ticamente al ingresar el c√≥digo en el checkout.
          </p>
        </div>
      </div>

      <!-- Limited Time Offers -->
      <div class="account-card">
        <div class="card-header">
          <div class="offers-header">
            <div>
              <h2 class="card-title">üî• Ofertas por Tiempo Limitado</h2>
              <p class="card-description">Ofertas exclusivas que expiran pronto</p>
            </div>
            <span class="offers-badge">¬°No te las pierdas!</span>
          </div>
        </div>
        <div class="card-content">
          <div class="offers-list">
            <!-- Offer 1 -->
            <div class="offer-item offer-urgent">
              <div class="offer-timer" id="timer-flash-sale">
                <svg class="timer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span class="timer-label">Expira en:</span>
                <div class="countdown" data-hours="2" data-minutes="45" data-seconds="30">
                  <span class="countdown-segment">
                    <span class="countdown-value" id="hours-1">02</span>
                    <span class="countdown-unit">hrs</span>
                  </span>
                  <span class="countdown-separator">:</span>
                  <span class="countdown-segment">
                    <span class="countdown-value" id="minutes-1">45</span>
                    <span class="countdown-unit">min</span>
                  </span>
                  <span class="countdown-separator">:</span>
                  <span class="countdown-segment">
                    <span class="countdown-value" id="seconds-1">30</span>
                    <span class="countdown-unit">seg</span>
                  </span>
                </div>
              </div>
              <div class="offer-content">
                <div class="offer-badge">‚ö° FLASH SALE</div>
                <h3 class="offer-title">30% en toda la tienda</h3>
                <p class="offer-description">Aprovecha este descuento exclusivo en todos los productos. ¬°Solo por hoy!</p>
                <div class="offer-actions">
                  <div class="coupon-code-wrapper">
                    <span class="coupon-code">FLASH30</span>
                    <button class="copy-btn" data-code="FLASH30">
                      <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                      </svg>
                    </button>
                  </div>
                  <a href="/collections/all" class="btn btn-primary btn-sm">Comprar ahora</a>
                </div>
              </div>
            </div>

            <div class="divider"></div>

            <!-- Offer 2 -->
            <div class="offer-item">
              <div class="offer-timer" id="timer-weekend">
                <svg class="timer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span class="timer-label">Termina en:</span>
                <div class="countdown" data-hours="48" data-minutes="0" data-seconds="0">
                  <span class="countdown-segment">
                    <span class="countdown-value" id="hours-2">48</span>
                    <span class="countdown-unit">hrs</span>
                  </span>
                  <span class="countdown-separator">:</span>
                  <span class="countdown-segment">
                    <span class="countdown-value" id="minutes-2">00</span>
                    <span class="countdown-unit">min</span>
                  </span>
                  <span class="countdown-separator">:</span>
                  <span class="countdown-segment">
                    <span class="countdown-value" id="seconds-2">00</span>
                    <span class="countdown-unit">seg</span>
                  </span>
                </div>
              </div>
              <div class="offer-content">
                <div class="offer-badge offer-badge-secondary">üéâ FIN DE SEMANA</div>
                <h3 class="offer-title">2x1 en productos seleccionados</h3>
                <p class="offer-description">Compra un producto y ll√©vate otro gratis. Aplica en la categor√≠a de accesorios.</p>
                <div class="offer-actions">
                  <div class="coupon-code-wrapper">
                    <span class="coupon-code">2X1FINDE</span>
                    <button class="copy-btn" data-code="2X1FINDE">
                      <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                      </svg>
                    </button>
                  </div>
                  <a href="/collections/accesorios" class="btn btn-outline btn-sm">Ver productos</a>
                </div>
              </div>
            </div>

            <div class="divider"></div>

            <!-- Offer 3 -->
            <div class="offer-item">
              <div class="offer-timer" id="timer-vip">
                <svg class="timer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span class="timer-label">Exclusivo hasta:</span>
                <span class="offer-date">20 Ene 2026</span>
              </div>
              <div class="offer-content">
                <div class="offer-badge offer-badge-vip">üëë CLIENTE VIP</div>
                <h3 class="offer-title">Acceso anticipado a nueva colecci√≥n + 20% OFF</h3>
                <p class="offer-description">Como cliente VIP, tienes acceso exclusivo a nuestra nueva colecci√≥n con un descuento especial.</p>
                <div class="offer-actions">
                  <div class="coupon-code-wrapper">
                    <span class="coupon-code">VIP2026</span>
                    <button class="copy-btn" data-code="VIP2026">
                      <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                      </svg>
                    </button>
                  </div>
                  <a href="/collections/nueva-coleccion" class="btn btn-outline btn-sm">Explorar</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State (hidden by default, show when no coupons) -->
      <div class="empty-coupons" style="display: none;">
        <div class="empty-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M21 5H3a2 2 0 00-2 2v4a2 2 0 002 2 2 2 0 010 4 2 2 0 00-2 2v4a2 2 0 002 2h18a2 2 0 002-2v-4a2 2 0 00-2-2 2 2 0 010-4 2 2 0 002-2V7a2 2 0 00-2-2z"></path>
          </svg>
        </div>
        <h3 class="empty-title">No tienes cupones activos</h3>
        <p class="empty-description">Sigue comprando para desbloquear descuentos exclusivos</p>
        <a href="/collections/all" class="btn btn-primary">Explorar productos</a>
      </div>
    </div>
  </div>
</div>
</div>

<style>
  /* ============================================
     VARIABLES CSS - PERSONALIZA AQU√ç
     ============================================ */
  :root {
    --account-primary: #2563eb;
    --account-primary-hover: #1d4ed8;
    --account-primary-light: #dbeafe;
    --account-background: #f8fafc;
    --account-surface: #ffffff;
    --account-border: #e2e8f0;
    --account-text: #1e293b;
    --account-text-muted: #64748b;
    --account-text-light: #94a3b8;
    --account-success: #22c55e;
    --account-error: #ef4444;
    --account-warning: #f59e0b;
    --account-radius: 12px;
    --account-radius-sm: 8px;
    --account-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
    --account-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --account-transition: 0.2s ease;
  }

  /* ============================================
     RESET & BASE
     ============================================ */
  .account-page {
    max-width: 900px;
    margin: 0 auto;
    padding: 2rem 1rem;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    color: var(--account-text);
    line-height: 1.5;
  }

  .account-page * {
    box-sizing: border-box;
  }

  /* ============================================
     HEADER
     ============================================ */
  .account-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .account-avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--account-primary), var(--account-primary-hover));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 600;
    flex-shrink: 0;
  }

  .account-title {
    font-size: 1.75rem;
    font-weight: 700;
    margin: 0 0 0.25rem 0;
    color: var(--account-text);
  }

  .account-subtitle {
    margin: 0;
    color: var(--account-text-muted);
    font-size: 0.875rem;
  }

  /* ============================================
     TABS
     ============================================ */
  .account-tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    background: var(--account-background);
    padding: 0.375rem;
    border-radius: var(--account-radius);
    overflow-x: auto;
  }

  .account-tab {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    border: none;
    background: transparent;
    color: var(--account-text-muted);
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: var(--account-radius-sm);
    cursor: pointer;
    transition: all var(--account-transition);
    white-space: nowrap;
  }

  .account-tab:hover {
    color: var(--account-text);
    background: var(--account-surface);
  }

  .account-tab.active {
    background: var(--account-surface);
    color: var(--account-primary);
    box-shadow: var(--account-shadow);
  }

  .tab-icon {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
  }

  /* ============================================
     PANELS
     ============================================ */
  .account-panels {
    position: relative;
  }

  .account-panel {
    display: none;
    animation: fadeIn 0.3s ease;
  }

  .account-panel.active {
    display: block;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* ============================================
     CARDS
     ============================================ */
  .account-card {
    background: var(--account-surface);
    border: 1px solid var(--account-border);
    border-radius: var(--account-radius);
    margin-bottom: 1.5rem;
    overflow: hidden;
  }

  .card-header {
    padding: 1.5rem 1.5rem 0;
  }

  .card-title {
    font-size: 1.125rem;
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    color: var(--account-text);
  }

  .card-description {
    margin: 0;
    color: var(--account-text-muted);
    font-size: 0.875rem;
  }

  .card-content {
    padding: 1.5rem;
  }

  /* ============================================
     AVATAR SECTION
     ============================================ */
  .avatar-section {
    margin-bottom: 1rem;
  }

  .avatar-upload {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }

  .avatar-large {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--account-primary), var(--account-primary-hover));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    font-weight: 600;
    flex-shrink: 0;
  }

  .avatar-actions {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .avatar-hint {
    margin: 0;
    font-size: 0.75rem;
    color: var(--account-text-light);
  }

  /* ============================================
     FORM ELEMENTS
     ============================================ */
  .form-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  @media (max-width: 640px) {
    .form-grid {
      grid-template-columns: 1fr;
    }
  }

  .form-group {
    margin-bottom: 1rem;
  }

  .form-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 500;
    margin-bottom: 0.5rem;
    color: var(--account-text);
  }

  .form-input,
  .form-select {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 1px solid var(--account-border);
    border-radius: var(--account-radius-sm);
    font-size: 0.875rem;
    color: var(--account-text);
    background: var(--account-surface);
    transition: all var(--account-transition);
  }

  .form-input:focus,
  .form-select:focus {
    outline: none;
    border-color: var(--account-primary);
    box-shadow: 0 0 0 3px var(--account-primary-light);
  }

  .form-input::placeholder {
    color: var(--account-text-light);
  }

  .form-hint {
    margin: 0.375rem 0 0;
    font-size: 0.75rem;
    color: var(--account-text-muted);
  }

  .form-error {
    margin: 0.375rem 0 0;
    font-size: 0.75rem;
    color: var(--account-error);
  }

  .form-actions {
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--account-border);
  }

  /* Password Input Wrapper */
  .password-input-wrapper {
    position: relative;
  }

  .password-input-wrapper .form-input {
    padding-right: 3rem;
  }

  .password-toggle {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.25rem;
    color: var(--account-text-muted);
    transition: color var(--account-transition);
  }

  .password-toggle:hover {
    color: var(--account-text);
  }

  .eye-icon {
    width: 20px;
    height: 20px;
  }

  /* Select Wrapper */
  .select-wrapper {
    position: relative;
  }

  .form-select {
    appearance: none;
    padding-right: 2.5rem;
    cursor: pointer;
  }

  .select-arrow {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 20px;
    pointer-events: none;
    color: var(--account-text-muted);
  }

  /* ============================================
     BUTTONS
     ============================================ */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: var(--account-radius-sm);
    font-size: 0.875rem;
    font-weight: 500;
    border: none;
    cursor: pointer;
    transition: all var(--account-transition);
  }

  .btn-primary {
    background: var(--account-primary);
    color: white;
  }

  .btn-primary:hover {
    background: var(--account-primary-hover);
  }

  .btn-outline {
    background: transparent;
    border: 1px solid var(--account-border);
    color: var(--account-text);
  }

  .btn-outline:hover {
    background: var(--account-background);
    border-color: var(--account-text-muted);
  }

  .btn-sm {
    padding: 0.5rem 1rem;
    font-size: 0.8125rem;
  }

  .btn-icon {
    width: 16px;
    height: 16px;
  }

  /* ============================================
     TOGGLE SWITCH
     ============================================ */
  .toggle-list {
    display: flex;
    flex-direction: column;
  }

  .toggle-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    padding: 0.5rem 0;
  }

  .toggle-info {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  .toggle-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--account-text);
  }

  .toggle-description {
    font-size: 0.75rem;
    color: var(--account-text-muted);
  }

  .toggle-switch {
    position: relative;
    display: inline-block;
    width: 44px;
    height: 24px;
    flex-shrink: 0;
  }

  .toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--account-border);
    border-radius: 24px;
    transition: all var(--account-transition);
  }

  .toggle-slider::before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background: white;
    border-radius: 50%;
    transition: all var(--account-transition);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }

  .toggle-switch input:checked + .toggle-slider {
    background: var(--account-primary);
  }

  .toggle-switch input:checked + .toggle-slider::before {
    transform: translateX(20px);
  }

  .toggle-switch input:focus + .toggle-slider {
    box-shadow: 0 0 0 3px var(--account-primary-light);
  }

  /* ============================================
     UTILITIES
     ============================================ */
  .divider {
    height: 1px;
    background: var(--account-border);
    margin: 1rem 0;
  }

  .info-note {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    margin-top: 1rem;
    padding: 0.75rem 1rem;
    background: var(--account-primary-light);
    border-radius: var(--account-radius-sm);
    font-size: 0.8125rem;
    color: var(--account-primary-hover);
  }

  .info-icon {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
    margin-top: 1px;
  }

  /* ============================================
     TOAST NOTIFICATIONS
     ============================================ */
  #toast-container {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .toast {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 1.25rem;
    background: var(--account-surface);
    border: 1px solid var(--account-border);
    border-radius: var(--account-radius-sm);
    box-shadow: var(--account-shadow-lg);
    animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
    max-width: 350px;
  }

  .toast.success {
    border-left: 4px solid var(--account-success);
  }

  .toast.error {
    border-left: 4px solid var(--account-error);
  }

  .toast.warning {
    border-left: 4px solid var(--account-warning);
  }

  .toast-message {
    font-size: 0.875rem;
    color: var(--account-text);
  }

  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  /* ============================================
     COUPONS & OFFERS
     ============================================ */
  .coupons-grid {
    display: grid;
    gap: 1rem;
  }

  .coupon-card {
    display: flex;
    border: 2px dashed var(--account-border);
    border-radius: var(--account-radius);
    overflow: hidden;
    background: var(--account-surface);
    transition: all var(--account-transition);
  }

  .coupon-card:hover {
    border-color: var(--account-primary);
    box-shadow: var(--account-shadow);
  }

  .coupon-left {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1.5rem 1.25rem;
    background: linear-gradient(135deg, var(--account-primary), var(--account-primary-hover));
    color: white;
    min-width: 100px;
    text-align: center;
  }

  .coupon-left-secondary {
    background: linear-gradient(135deg, #10b981, #059669);
  }

  .coupon-left-accent {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
  }

  .coupon-discount {
    font-size: 1.75rem;
    font-weight: 700;
    line-height: 1;
  }

  .coupon-type {
    font-size: 0.625rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: 0.25rem;
    opacity: 0.9;
  }

  .shipping-icon {
    width: 32px;
    height: 32px;
  }

  .coupon-right {
    flex: 1;
    padding: 1rem 1.25rem;
    display: flex;
    flex-direction: column;
    gap: 0.375rem;
  }

  .coupon-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--account-text);
  }

  .coupon-description {
    font-size: 0.8125rem;
    color: var(--account-text-muted);
  }

  .coupon-code-wrapper {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.25rem;
  }

  .coupon-code {
    display: inline-block;
    padding: 0.375rem 0.75rem;
    background: var(--account-background);
    border: 1px dashed var(--account-primary);
    border-radius: var(--account-radius-sm);
    font-family: monospace;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--account-primary);
    letter-spacing: 0.025em;
  }

  .copy-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border: 1px solid var(--account-border);
    border-radius: var(--account-radius-sm);
    background: var(--account-surface);
    cursor: pointer;
    transition: all var(--account-transition);
    color: var(--account-text-muted);
  }

  .copy-btn:hover {
    background: var(--account-primary);
    border-color: var(--account-primary);
    color: white;
  }

  .copy-icon {
    width: 16px;
    height: 16px;
  }

  .coupon-expiry {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.75rem;
    color: var(--account-text-light);
    margin-top: 0.25rem;
  }

  .clock-icon {
    width: 14px;
    height: 14px;
  }

  /* Offers Section */
  .offers-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
  }

  .offers-badge {
    display: inline-block;
    padding: 0.375rem 0.75rem;
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    border-radius: 9999px;
    white-space: nowrap;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  .offers-list {
    display: flex;
    flex-direction: column;
  }

  .offer-item {
    padding: 1.25rem 0;
  }

  .offer-item.offer-urgent {
    background: linear-gradient(90deg, rgba(239, 68, 68, 0.05), transparent);
    margin: -1.25rem -1.5rem;
    padding: 1.25rem 1.5rem;
    border-left: 3px solid #ef4444;
  }

  .offer-timer {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    font-size: 0.8125rem;
    color: var(--account-text-muted);
  }

  .timer-icon {
    width: 16px;
    height: 16px;
    color: var(--account-error);
  }

  .timer-label {
    color: var(--account-text-muted);
  }

  .countdown {
    display: flex;
    align-items: center;
    gap: 0.125rem;
    font-family: monospace;
  }

  .countdown-segment {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .countdown-value {
    font-size: 1rem;
    font-weight: 700;
    color: var(--account-error);
    background: rgba(239, 68, 68, 0.1);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    min-width: 2rem;
    text-align: center;
  }

  .countdown-unit {
    font-size: 0.625rem;
    color: var(--account-text-light);
    text-transform: uppercase;
    margin-top: 0.125rem;
  }

  .countdown-separator {
    font-size: 1rem;
    font-weight: 700;
    color: var(--account-error);
    margin: 0 0.125rem;
    margin-bottom: 0.875rem;
  }

  .offer-date {
    font-weight: 600;
    color: var(--account-text);
  }

  .offer-content {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .offer-badge {
    display: inline-block;
    width: fit-content;
    padding: 0.25rem 0.625rem;
    background: #fef2f2;
    color: #dc2626;
    font-size: 0.6875rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-radius: 4px;
  }

  .offer-badge-secondary {
    background: #fef3c7;
    color: #d97706;
  }

  .offer-badge-vip {
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    color: #92400e;
  }

  .offer-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--account-text);
    margin: 0;
  }

  .offer-description {
    font-size: 0.875rem;
    color: var(--account-text-muted);
    margin: 0;
  }

  .offer-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-top: 0.5rem;
  }

  /* Empty State */
  .empty-coupons {
    text-align: center;
    padding: 3rem 1.5rem;
    background: var(--account-surface);
    border: 1px solid var(--account-border);
    border-radius: var(--account-radius);
  }

  .empty-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 1rem;
    color: var(--account-text-light);
  }

  .empty-icon svg {
    width: 100%;
    height: 100%;
  }

  .empty-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--account-text);
    margin: 0 0 0.5rem 0;
  }

  .empty-description {
    font-size: 0.875rem;
    color: var(--account-text-muted);
    margin: 0 0 1.5rem 0;
  }

  /* ============================================
     RESPONSIVE
     ============================================ */
  @media (max-width: 640px) {
    .account-page {
      padding: 1rem;
    }

    .account-header {
      flex-direction: column;
      text-align: center;
    }

    .account-tabs {
      justify-content: stretch;
    }

    .account-tab {
      flex: 1;
      justify-content: center;
      padding: 0.625rem 0.75rem;
      font-size: 0.8125rem;
    }

    .tab-icon {
      display: none;
    }

    .avatar-upload {
      flex-direction: column;
      text-align: center;
    }

    .card-header,
    .card-content {
      padding: 1rem;
    }

    /* Coupon responsive */
    .coupon-card {
      flex-direction: column;
    }

    .coupon-left {
      flex-direction: row;
      gap: 0.5rem;
      padding: 1rem;
      min-width: auto;
    }

    .coupon-discount {
      font-size: 1.5rem;
    }

    .offers-header {
      flex-direction: column;
      align-items: flex-start;
    }

    .offer-actions {
      flex-direction: column;
      align-items: flex-start;
    }

    .countdown {
      flex-wrap: wrap;
    }
  }
</style>

<script>
  (function() {
    'use strict';

    // ============================================
    // TAB SWITCHING
    // ============================================
    const tabs = document.querySelectorAll('.account-tab');
    const panels = document.querySelectorAll('.account-panel');

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const targetId = tab.dataset.tab;
        
        // Update tabs
        tabs.forEach(t => {
          t.classList.remove('active');
          t.setAttribute('aria-selected', 'false');
        });
        tab.classList.add('active');
        tab.setAttribute('aria-selected', 'true');

        // Update panels
        panels.forEach(panel => {
          panel.classList.remove('active');
        });
        document.getElementById('panel-' + targetId).classList.add('active');
      });
    });

    // ============================================
    // PASSWORD VISIBILITY TOGGLE
    // ============================================
    const passwordToggles = document.querySelectorAll('.password-toggle');
    
    passwordToggles.forEach(toggle => {
      toggle.addEventListener('click', () => {
        const targetId = toggle.dataset.target;
        const input = document.getElementById(targetId);
        
        if (input.type === 'password') {
          input.type = 'text';
          toggle.innerHTML = `
            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
              <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
          `;
        } else {
          input.type = 'password';
          toggle.innerHTML = `
            <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          `;
        }
      });
    });

    // ============================================
    // PASSWORD VALIDATION
    // ============================================
    const passwordForm = document.getElementById('password-form');
    const newPassword = document.getElementById('new_password');
    const confirmPassword = document.getElementById('confirm_password');
    const passwordError = document.getElementById('password-error');

    if (passwordForm) {
      passwordForm.addEventListener('submit', (e) => {
        if (newPassword.value !== confirmPassword.value) {
          e.preventDefault();
          passwordError.hidden = false;
          confirmPassword.focus();
          showToast('Las contrase√±as no coinciden', 'error');
        } else if (newPassword.value.length < 8) {
          e.preventDefault();
          showToast('La contrase√±a debe tener al menos 8 caracteres', 'error');
        } else {
          passwordError.hidden = true;
        }
      });

      // Real-time validation
      confirmPassword.addEventListener('input', () => {
        if (newPassword.value && confirmPassword.value) {
          passwordError.hidden = newPassword.value === confirmPassword.value;
        }
      });
    }

    // ============================================
    // PROFILE FORM SUBMIT
    // ============================================
    const profileForm = document.getElementById('profile-form');
    
    if (profileForm) {
      profileForm.addEventListener('submit', (e) => {
        // Shopify handles the form, but show feedback
        setTimeout(() => {
          showToast('Perfil actualizado correctamente', 'success');
        }, 500);
      });
    }

    // ============================================
    // PREFERENCES SAVE
    // ============================================
    const savePreferencesBtn = document.getElementById('save-preferences');
    
    if (savePreferencesBtn) {
      savePreferencesBtn.addEventListener('click', () => {
        // Collect preferences
        const preferences = {
          language: document.getElementById('language').value,
          emailNotifications: document.getElementById('toggle-email').checked,
          smsNotifications: document.getElementById('toggle-sms').checked,
          orderUpdates: document.getElementById('toggle-orders').checked,
          promotions: document.getElementById('toggle-promos').checked
        };

        // Here you would save to Shopify metafields via AJAX
        // For now, just show success message
        console.log('Saving preferences:', preferences);
        
        // Simulate save
        savePreferencesBtn.textContent = 'Guardando...';
        savePreferencesBtn.disabled = true;
        
        setTimeout(() => {
          savePreferencesBtn.textContent = 'Guardar preferencias';
          savePreferencesBtn.disabled = false;
          showToast('Preferencias guardadas correctamente', 'success');
        }, 800);
      });
    }

    // ============================================
    // 2FA TOGGLE
    // ============================================
    const toggle2fa = document.getElementById('toggle-2fa');
    
    if (toggle2fa) {
      toggle2fa.addEventListener('change', () => {
        if (toggle2fa.checked) {
          showToast('2FA activado (demo)', 'success');
        } else {
          showToast('2FA desactivado', 'warning');
        }
      });
    }

    // ============================================
    // AVATAR UPLOAD (Preview only)
    // ============================================
    const avatarInput = document.getElementById('avatar-input');
    const avatarDisplay = document.getElementById('avatar-display');
    
    if (avatarInput && avatarDisplay) {
      avatarInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
          if (file.size > 2 * 1024 * 1024) {
            showToast('La imagen no puede superar 2MB', 'error');
            return;
          }
          
          const reader = new FileReader();
          reader.onload = (event) => {
            avatarDisplay.innerHTML = '';
            avatarDisplay.style.backgroundImage = `url(${event.target.result})`;
            avatarDisplay.style.backgroundSize = 'cover';
            avatarDisplay.style.backgroundPosition = 'center';
            showToast('Imagen cargada (vista previa)', 'success');
          };
          reader.readAsDataURL(file);
        }
      });
    }

    // ============================================
    // TOAST NOTIFICATION SYSTEM
    // ============================================
    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      const icons = {
        success: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>`,
        error: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>`,
        warning: `<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>`
      };

      toast.innerHTML = `
        ${icons[type]}
        <span class="toast-message">${message}</span>
      `;

      container.appendChild(toast);

      // Auto remove after 3 seconds
      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    // Make showToast globally available
    window.showToast = showToast;

    // ============================================
    // COPY COUPON CODE
    // ============================================
    const copyButtons = document.querySelectorAll('.copy-btn');
    
    copyButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const code = btn.dataset.code;
        
        // Copy to clipboard
        if (navigator.clipboard) {
          navigator.clipboard.writeText(code).then(() => {
            showToast(`C√≥digo "${code}" copiado al portapapeles`, 'success');
            
            // Visual feedback
            btn.innerHTML = `
              <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
            `;
            
            setTimeout(() => {
              btn.innerHTML = `
                <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              `;
            }, 2000);
          }).catch(() => {
            fallbackCopy(code);
          });
        } else {
          fallbackCopy(code);
        }
      });
    });

    function fallbackCopy(text) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.select();
      
      try {
        document.execCommand('copy');
        showToast(`C√≥digo "${text}" copiado al portapapeles`, 'success');
      } catch (err) {
        showToast('No se pudo copiar el c√≥digo', 'error');
      }
      
      document.body.removeChild(textarea);
    }

    // ============================================
    // COUNTDOWN TIMERS
    // ============================================
    function initCountdowns() {
      // Timer 1 - Flash Sale (2:45:30)
      let timer1 = { hours: 2, minutes: 45, seconds: 30 };
      updateCountdown('hours-1', 'minutes-1', 'seconds-1', timer1);
      
      // Timer 2 - Weekend (48:00:00)
      let timer2 = { hours: 48, minutes: 0, seconds: 0 };
      updateCountdown('hours-2', 'minutes-2', 'seconds-2', timer2);

      // Update every second
      setInterval(() => {
        // Timer 1
        timer1 = decrementTimer(timer1);
        updateCountdown('hours-1', 'minutes-1', 'seconds-1', timer1);
        
        // Timer 2
        timer2 = decrementTimer(timer2);
        updateCountdown('hours-2', 'minutes-2', 'seconds-2', timer2);
      }, 1000);
    }

    function decrementTimer(timer) {
      let { hours, minutes, seconds } = timer;
      
      seconds--;
      if (seconds < 0) {
        seconds = 59;
        minutes--;
        if (minutes < 0) {
          minutes = 59;
          hours--;
          if (hours < 0) {
            hours = 0;
            minutes = 0;
            seconds = 0;
          }
        }
      }
      
      return { hours, minutes, seconds };
    }

    function updateCountdown(hoursId, minutesId, secondsId, timer) {
      const hoursEl = document.getElementById(hoursId);
      const minutesEl = document.getElementById(minutesId);
      const secondsEl = document.getElementById(secondsId);
      
      if (hoursEl) hoursEl.textContent = String(timer.hours).padStart(2, '0');
      if (minutesEl) minutesEl.textContent = String(timer.minutes).padStart(2, '0');
      if (secondsEl) secondsEl.textContent = String(timer.seconds).padStart(2, '0');
    }

    // Initialize countdowns
    initCountdowns();

  })();
</script>
